<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subcutaneous Administration | Patient Guide</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <link rel="stylesheet" href="../education.css">

    <style>
        /* --- SUBCUT SPECIFIC STYLES --- */
        
        .fear-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%) !important;
            color: #333 !important;
        }

        .rule-card {
            border-left: 5px solid #0061f2 !important;
        }
        .rule-number {
            background: #0061f2 !important;
        }

        .checklist-ul { padding-left: 20px; margin-top: 5px; font-size: 14px; }
        .checklist-ul li { margin-bottom: 4px; }

        .side-effect {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 20px; border-radius: 16px; border-left: 5px solid #ff8c42; margin-bottom: 24px;
        }
        .side-effect strong { color: #e74c3c; display: block; margin-bottom: 8px; font-size: 18px; }

        /* --- PDF PRINT STYLES --- */
        #print-area {
            position: absolute; top: -9999px; left: -9999px;
            width: 794px; background: white; color: #333;
            padding: 40px; box-sizing: border-box;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            display: flex; flex-direction: column; gap: 20px;
        }
        #print-area .print-header { border-bottom: 3px solid #0061f2; padding-bottom: 10px; margin-bottom: 10px; }
        #print-area h1 { color: #0061f2; font-size: 28px; margin: 0; }
        #print-area h2 { 
            font-size: 18px; color: #2c3e50; border-bottom: 1px solid #ddd; 
            padding-bottom: 6px; margin: 15px 0 10px 0; text-transform: uppercase; letter-spacing: 0.5px;
        }
        
        .print-section { margin-bottom: 10px; }
        
        .print-warning-box {
            border: 2px solid #e74c3c; background: #fff5f5; padding: 12px 16px; 
            border-radius: 8px; color: #c0392b; display: flex; align-items: center; gap: 15px;
        }
        
        .print-prep-row { display: flex; gap: 20px; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e9ecef; }
        .print-prep-col { flex: 1; }
        .print-prep-col strong { color: #0061f2; display: block; margin-bottom: 6px; font-size: 15px; }
        .print-prep-col ul { margin: 0; padding-left: 20px; font-size: 13px; color: #444; }

        .print-step {
            display: flex; gap: 15px; padding: 12px; margin-bottom: 10px;
            border: 1px solid #eee; border-radius: 8px; background: #fff;
            break-inside: avoid;
        }
        .step-num {
            background: #0061f2; color: white; width: 28px; height: 28px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 14px; flex-shrink: 0; margin-top: 2px;
        }
        .step-content { flex: 1; }
        .step-content > strong { display: block; font-size: 15px; margin-bottom: 4px; color: #2c3e50; }
        .step-content p { font-size: 13px; color: #555; margin: 0; line-height: 1.4; }
        .step-imgs { display: flex; gap: 10px; flex-shrink: 0; }
        .print-img-sm { width: 90px; height: 90px; object-fit: contain; border: 1px solid #eee; border-radius: 4px; padding: 2px; background: white; }
    </style>
</head>
<body><div class="main-container">
    <div id="pdf-loading">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem; margin-bottom: 20px; border: 4px solid #0061f2; border-right-color: transparent; border-radius: 50%; animation: spin .75s linear infinite;"></div>
        <div style="font-weight: bold; color: #555;">Generating PDF...</div>
        <div style="font-size: 13px; color: #888; margin-top: 5px;">Formatting & Adding Footer</div>
    </div>

    <div class="header header-mbo">
        <div id="inst-header-container" class="inst-header-container">
            <img id="inst-logo-img" class="inst-logo" src="" alt="Logo" style="display:none;">
            <div class="inst-info">
                <h3 id="inst-name-display"></h3>
                <p id="inst-contact-display"></p>
            </div>
        </div>
        <h1>💉 Subcut Administration</h1>
        <p>Home Guide for Subcutaneous Injection</p>
    </div>

    <div class="nav-bar">
        <div id="backBtn" class="nav-link mbo-theme" onclick="window.history.back()">
            <i class="bi bi-arrow-left"></i> Back
        </div>
        <div class="nav-link mbo-theme" onclick="showQR()">
            <i class="bi bi-share-fill"></i> Share
        </div>
    </div>

    <div class="section" style="padding-bottom: 10px;">
        <h2><i class="bi bi-exclamation-triangle-fill"></i> Safety Check</h2>
        <div class="side-effect">
            <strong>⚠️ WHEN TO CALL THE NURSE</strong>
            <p>Do not inject. Call immediately if the port area is: <strong>Red, Swollen, Leaking Fluid, or Painful.</strong></p>
        </div>
    </div>

    <div class="section">
        <h2><i class="bi bi-clipboard-check-fill"></i> Preparation</h2>
        <div class="fear-grid">
            <div class="fear-card">
                <strong>1. Wash & Check</strong>
                <p>Wash hands with soap and water, dry well. Check chart for medicine name, amount, and time since last dose.</p>
            </div>
            <div class="fear-card">
                <strong>2. Gather Items</strong>
                <ul class="checklist-ul">
                    <li>Syringe with needle</li>
                    <li>Medicine ampoule</li>
                    <li>Water for injection syringe (0.5ml)</li>
                    <li>Alcohol wipes</li>
                    <li>Sharps box</li>
                </ul>
            </div>
            <img src="1.jpg" alt="Check and Gather" class="card-img">
        </div>
    </div>

    <div class="section">
        <h2><i class="bi bi-capsule-pill"></i> Injection Steps</h2>
        <div class="rules-grid">
            
            <div class="rule-card">
                <div class="rule-number">1</div>
                <div class="rule-content">
                    <strong>Draw Medicine</strong>
                    <p>Snap open ampoule (break at colored dot). Stick needle in, pull plunger to exact amount. Tap to remove bubbles, push plunger slightly to expel air.</p>
                    <img src="2.jpg" alt="Draw Medicine Step A" class="card-img">
                </div>
            </div>

            <div class="rule-card">
                <div class="rule-number">2</div>
                <div class="rule-content">
                    <strong>Give Medicine</strong>
                    <p>Wipe port stopper with alcohol wipe, wait 30s. Push needle gently into port. Push plunger <strong>slowly</strong> until empty. Pull needle out straight away.</p>
                    <img src="3.jpg" alt="Give Medicine" class="card-img">
                </div>
            </div>

            <div class="rule-card" style="border-left-color: #2ecc71 !important;">
                <div class="rule-number" style="background: #2ecc71 !important;"><i class="bi bi-check-lg"></i></div>
                <div class="rule-content">
                    <strong>Rinse After & Finish</strong>
                    <p>Push needle of <strong>water for injection syringe</strong> (0.5ml) into port, push slowly to rinse. Wipe port stopper with alcohol wipe. Record details on chart. Drop all sharps in box.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="action-buttons no-print">
        <button class="btn btn-mbo" onclick="generateAndPrintPDF('subcut-guide-eng.pdf')">
            <i class="bi bi-printer-fill"></i> Print PDF
        </button>
    </div>

    <div id="qr-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeQR()">&times;</span>
            <h3 style="margin: 0 0 20px 0;">📱 Share Protocol</h3>
            <div id="qrcode-wrapper-safe">
                <div id="qrcode"></div>
            </div>
            <p style="text-align: center; color: #666;">Scan QR code to view on mobile</p>
        </div>
    </div>

    <div id="print-area">
        <div class="print-header">
            <h1>Subcutaneous Administration</h1>
            <p>Home Care Protocol</p>
        </div>

        <div class="print-section">
            <h2 style="color: #c0392b; border-bottom-color: #fadbd8;">Safety Check</h2>
            <div class="print-warning-box">
                <div style="font-size: 24px;">⚠️</div>
                <div>
                    <strong style="color:#c0392b;">WHEN TO CALL THE NURSE</strong>
                    <p style="margin: 0; font-size: 13px;">Do not inject if port is: <strong>Red, Swollen, Leaking Fluid, or Painful.</strong></p>
                </div>
            </div>
        </div>

        <div class="print-section">
            <h2>Preparation</h2>
            <div class="print-prep-row">
                <div class="print-prep-col">
                    <strong>1. Wash & Check</strong>
                    <p style="font-size: 13px; margin:0;">Wash hands with soap. Check chart for right medicine, amount, and time.</p>
                </div>
                <div class="print-prep-col">
                    <strong>2. Gather Items</strong>
                    <ul>
                        <li>Syringe with needle</li>
                        <li>Medicine ampoule</li>
                        <li>Water for injection (0.5ml)</li>
                        <li>Alcohol wipes & Sharps box</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="print-section">
            <h2>Administration Procedure</h2>

            <div class="print-step">
                <div class="step-num">1</div>
                <div class="step-content">
                    <strong>Draw Medicine</strong>
                    <p>Snap ampoule. Draw exact amount. Tap to remove bubbles, push plunger slightly to expel air.</p>
                </div>
                <div class="step-imgs">
                    <img src="2.jpg" class="print-img-sm" alt="Ampoule">
                </div>
            </div>

            <div class="print-step">
                <div class="step-num">2</div>
                <div class="step-content">
                    <strong>Give Medicine</strong>
                    <p>Wipe port stopper with alcohol wipe (wait 30s). Push needle in. Inject <strong>SLOWLY</strong>. Pull out straight away.</p>
                </div>
                <div class="step-imgs">
                    <img src="3.jpg" class="print-img-sm" alt="Inject">
                </div>
            </div>

            <div class="print-step">
                <div class="step-num">3</div>
                <div class="step-content">
                    <strong>Rinse After & Finish</strong>
                    <p>Rinse with water for injection (0.5ml). Wipe port stopper. Record time/amount. Dispose of sharps.</p>
                </div>
                <div class="step-imgs">
                </div>
            </div>
        </div>
    </div>

</div><script src="../education.js"></script>
</body>
</html>