<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>皮下注射 | 患者指南</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <link rel="stylesheet" href="../education.css">

    <style>
        /* --- SUBCUT SPECIFIC STYLES --- */
        
        .fear-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%) !important;
            color: #333 !important;
        }

        .rule-card {
            border-left: 5px solid #0061f2 !important;
        }
        .rule-number {
            background: #0061f2 !important;
        }

        .checklist-ul { padding-left: 20px; margin-top: 5px; font-size: 14px; }
        .checklist-ul li { margin-bottom: 4px; }

        .side-effect {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 20px; border-radius: 16px; border-left: 5px solid #ff8c42; margin-bottom: 24px;
        }
        .side-effect strong { color: #e74c3c; display: block; margin-bottom: 8px; font-size: 18px; }

        /* --- PDF PRINT STYLES --- */
        #print-area {
            position: absolute; top: -9999px; left: -9999px;
            width: 794px; background: white; color: #333;
            padding: 40px; box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Heiti SC', Arial, sans-serif;
            display: flex; flex-direction: column; gap: 20px;
        }
        #print-area .print-header { border-bottom: 3px solid #0061f2; padding-bottom: 10px; margin-bottom: 10px; }
        #print-area h1 { color: #0061f2; font-size: 28px; margin: 0; }
        #print-area h2 { 
            font-size: 18px; color: #2c3e50; border-bottom: 1px solid #ddd; 
            padding-bottom: 6px; margin: 15px 0 10px 0; text-transform: uppercase; letter-spacing: 0.5px;
        }
        
        .print-section { margin-bottom: 10px; }
        
        .print-warning-box {
            border: 2px solid #e74c3c; background: #fff5f5; padding: 12px 16px; 
            border-radius: 8px; color: #c0392b; display: flex; align-items: center; gap: 15px;
        }
        
        .print-prep-row { display: flex; gap: 20px; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e9ecef; }
        .print-prep-col { flex: 1; }
        .print-prep-col strong { color: #0061f2; display: block; margin-bottom: 6px; font-size: 15px; }
        .print-prep-col ul { margin: 0; padding-left: 20px; font-size: 13px; color: #444; }

        .print-step {
            display: flex; gap: 15px; padding: 12px; margin-bottom: 10px;
            border: 1px solid #eee; border-radius: 8px; background: #fff;
            break-inside: avoid;
        }
        .step-num {
            background: #0061f2; color: white; width: 28px; height: 28px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 14px; flex-shrink: 0; margin-top: 2px;
        }
        .step-content { flex: 1; }
        .step-content > strong { display: block; font-size: 15px; margin-bottom: 4px; color: #2c3e50; }
        .step-content p { font-size: 13px; color: #555; margin: 0; line-height: 1.4; }
        .step-imgs { display: flex; gap: 10px; flex-shrink: 0; }
        .print-img-sm { width: 90px; height: 90px; object-fit: contain; border: 1px solid #eee; border-radius: 4px; padding: 2px; background: white; }
    </style>
</head>
<body><div class="main-container">
    <div id="pdf-loading">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem; margin-bottom: 20px; border: 4px solid #0061f2; border-right-color: transparent; border-radius: 50%; animation: spin .75s linear infinite;"></div>
        <div style="font-weight: bold; color: #555;">正在生成 PDF...</div>
        <div style="font-size: 13px; color: #888; margin-top: 5px;">正在排版并添加页脚</div>
    </div>

    <div class="header header-mbo">
        <div id="inst-header-container" class="inst-header-container">
            <img id="inst-logo-img" class="inst-logo" src="" alt="Logo" style="display:none;">
            <div class="inst-info">
                <h3 id="inst-name-display"></h3>
                <p id="inst-contact-display"></p>
            </div>
        </div>
        <h1>💉 皮下注射</h1>
        <p>居家护理指南 (Subcutaneous Administration)</p>
    </div>

    <div class="nav-bar">
        <div id="backBtn" class="nav-link mbo-theme" onclick="window.history.back()">
            <i class="bi bi-arrow-left"></i> 返回
        </div>
        <div class="nav-link mbo-theme" onclick="showQR()">
            <i class="bi bi-share-fill"></i> 分享
        </div>
    </div>

    <div class="section" style="padding-bottom: 10px;">
        <h2><i class="bi bi-exclamation-triangle-fill"></i> 安全检查</h2>
        <div class="side-effect">
            <strong>⚠️ 何时需要联络护士</strong>
            <p>如果注射口部位出现以下情况，请勿注射，并立即求助：<strong>红肿、渗液或疼痛。</strong></p>
        </div>
    </div>

    <div class="section">
        <h2><i class="bi bi-clipboard-check-fill"></i> 准备工作</h2>
        <div class="fear-grid">
            <div class="fear-card">
                <strong>1. 清洗与检查</strong>
                <p>用肥皂和水洗手并擦干。检查记录表上的药物名称、剂量以及距离上次给药的时间。</p>
            </div>
            <div class="fear-card">
                <strong>2. 准备物品</strong>
                <ul class="checklist-ul">
                    <li>带针头的注射器</li>
                    <li>药物安瓿 (药瓶)</li>
                    <li>注射用水针筒 (0.5ml)</li>
                    <li>酒精棉片</li>
                    <li>利器盒 (Sharps box)</li>
                </ul>
            </div>
            <img src="1.jpg" alt="Check and Gather" class="card-img">
        </div>
    </div>

    <div class="section">
        <h2><i class="bi bi-capsule-pill"></i> 注射步骤</h2>
        <div class="rules-grid">
            
            <div class="rule-card">
                <div class="rule-number">1</div>
                <div class="rule-content">
                    <strong>抽取药液</strong>
                    <p>折断安瓿 (从色点处掰开)。插入针头，拉动柱塞抽取准确剂量。轻弹针筒去除气泡，轻轻推动柱塞排出空气。</p>
                    <img src="2.jpg" alt="Draw Medicine Step A" class="card-img">
                </div>
            </div>

            <div class="rule-card">
                <div class="rule-number">2</div>
                <div class="rule-content">
                    <strong>注射药物</strong>
                    <p>用酒精棉片擦拭注射口胶塞，等待30秒。将针头轻轻刺入注射口。<strong>缓慢</strong>推动柱塞直至注空。随即拔出针头。</p>
                    <img src="3.jpg" alt="Give Medicine" class="card-img">
                </div>
            </div>

            <div class="rule-card" style="border-left-color: #2ecc71 !important;">
                <div class="rule-number" style="background: #2ecc71 !important;"><i class="bi bi-check-lg"></i></div>
                <div class="rule-content">
                    <strong>冲管与善后</strong>
                    <p>将<strong>注射用水针筒</strong> (0.5ml) 的针头插入注射口，缓慢推注以冲洗导管。用酒精棉片擦拭注射口。在记录表上记录。将所有利器投入利器盒。</p>
                </div>
            </div>
        </div>
    </div>

    <div class="action-buttons no-print">
        <button class="btn btn-mbo" onclick="generateAndPrintPDF('subcut-guide-ch.pdf')">
            <i class="bi bi-printer-fill"></i> 打印 PDF
        </button>
    </div>

    <div id="qr-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeQR()">&times;</span>
            <h3 style="margin: 0 0 20px 0;">📱 分享指南</h3>
            <div id="qrcode-wrapper-safe">
                <div id="qrcode"></div>
            </div>
            <p style="text-align: center; color: #666;">扫描二维码在手机上查看</p>
        </div>
    </div>

    <div id="print-area">
        <div class="print-header">
            <h1>皮下注射 (Subcut Administration)</h1>
            <p>居家护理方案</p>
        </div>

        <div class="print-section">
            <h2 style="color: #c0392b; border-bottom-color: #fadbd8;">安全检查</h2>
            <div class="print-warning-box">
                <div style="font-size: 24px;">⚠️</div>
                <div>
                    <strong style="color:#c0392b;">何时需要联络护士</strong>
                    <p style="margin: 0; font-size: 13px;">如果注射口出现以下情况请勿注射：<strong>红肿、渗液或疼痛。</strong></p>
                </div>
            </div>
        </div>

        <div class="print-section">
            <h2>准备工作</h2>
            <div class="print-prep-row">
                <div class="print-prep-col">
                    <strong>1. 清洗与检查</strong>
                    <p style="font-size: 13px; margin:0;">用肥皂洗手。核对药物名称、剂量和时间。</p>
                </div>
                <div class="print-prep-col">
                    <strong>2. 准备物品</strong>
                    <ul>
                        <li>带针头的注射器</li>
                        <li>药物安瓿 (Ampoule)</li>
                        <li>注射用水 (0.5ml)</li>
                        <li>酒精棉片 & 利器盒</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="print-section">
            <h2>注射步骤</h2>

            <div class="print-step">
                <div class="step-num">1</div>
                <div class="step-content">
                    <strong>抽取药液</strong>
                    <p>折断安瓿。抽取准确剂量。轻弹去除气泡，轻推排出空气。</p>
                </div>
                <div class="step-imgs">
                    <img src="2.jpg" class="print-img-sm" alt="Ampoule">
                </div>
            </div>

            <div class="print-step">
                <div class="step-num">2</div>
                <div class="step-content">
                    <strong>注射药物</strong>
                    <p>用酒精棉擦拭注射口 (等待30秒)。刺入针头。<strong>缓慢</strong>推注。注射完立即拔出。</p>
                </div>
                <div class="step-imgs">
                    <img src="3.jpg" class="print-img-sm" alt="Inject">
                </div>
            </div>

            <div class="print-step">
                <div class="step-num">3</div>
                <div class="step-content">
                    <strong>冲管与善后</strong>
                    <p>用注射用水 (0.5ml) 冲管。擦拭注射口。记录时间/剂量。丢弃利器。</p>
                </div>
                <div class="step-imgs">
                </div>
            </div>
        </div>
    </div>

</div><script src="../education.js"></script>
</body>
</html>