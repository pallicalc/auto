<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Diagnostic Tools | PalliCalc</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<link rel="stylesheet" href="style.css">

<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
    /* Specific styles for headers and buttons in this page */
    .section-header-text {
        font-size: 1.1rem;
        font-weight: 800;
        color: #334155;
        margin: 30px 0 15px 0;
        padding-left: 10px;
        border-left: 4px solid #007bff;
    }
    
    .btn-start-assess {
        display: block;
        width: 100%;
        padding: 12px;
        background: #007bff; /* Matches your theme blue */
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 600;
        margin-top: 15px;
        transition: background 0.2s;
        text-align: center;
        border: none;
    }
    
    .btn-start-assess:hover {
        background: #0056b3;
        color: white;
    }

    /* Ensure pamphlet cards match education style */
    .pamphlet-section {
        background: #f8faff;
        border: 2px solid #007bff;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0,123,255,0.1);
    }

    /* Badge for the Report Card */
    .badge-card {
        background-color: #dc3545;
        color: white;
        font-size: 12px;
        padding: 2px 8px;
        border-radius: 12px;
        margin-left: 10px;
        vertical-align: middle;
        font-weight: bold;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    /* Report Grid Styles for the Modal */
    .report-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-bottom: 20px;
    }
    .input-group label {
        display: block;
        font-size: 11px;
        font-weight: bold;
        color: #555;
        margin-bottom: 2px;
    }
    .input-group input {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
        background: #f9f9f9;
        box-sizing: border-box; 
    }
</style>
</head>
<body>

    <div class="container">
        
        <div class="back-nav">
            <a href="index.html" class="back-link"><i class="bi bi-arrow-left"></i> Back</a>
        </div>

        <div id="sourceBanner" class="source-banner"></div>

        <div id="institutionHeader" class="institution-header" style="display: none;">
            <div id="headerLogoContainer" class="logo-container"></div>
            <div id="institutionName" class="institution-name"></div>
            <div id="institutionContact" class="institution-contact"></div>
        </div>

        <div id="headerPlaceholder" class="header-placeholder">
            <div style="font-size: 30px; margin-bottom: 10px;">üè•</div>
            <div style="font-style: italic; opacity: 0.8;">Institution header will appear here</div>
        </div>

        <div id="shareCallout" class="pamphlet-section" style="border-color: #198754; background-color: #f0fdf4; margin-top: 20px;">
            <div class="pamphlet-title" style="color: #198754;">
                Clinical Handover
                <span id="cardBadge" class="badge-card" style="display:none;">0</span>
            </div>
            <div class="pamphlet-subtitle">
                Generate WhatsApp summary or Google Form submission
            </div>
            
            <button onclick="openReportModal()" class="btn-start-assess" style="background-color: #198754;">
                <i class="bi bi-clipboard-check"></i> Generate Report
            </button>
        </div>

        <h1>Diagnostic Tools</h1>

        <section class="pamphlets-available">
            
            <div class="section-header-text">Clinician Assessment</div>

            <div class="pamphlet-section">
                <div class="pamphlet-title">FLACC Scale</div>
                <div class="pamphlet-subtitle">Pain scale for non-verbal / paediatric patients</div>
                <a href="diagnostic/flacc.html" class="btn-start-assess">Start Assessment</a>
            </div>

            <div class="pamphlet-section">
                <div class="pamphlet-title">RASS</div>
                <div class="pamphlet-subtitle">Richmond Agitation-Sedation Scale</div>
                <a href="diagnostic/rass.html" class="btn-start-assess">Start Assessment</a>
            </div>

            <div class="pamphlet-section">
                <div class="pamphlet-title">AKPS</div>
                <div class="pamphlet-subtitle">Australia-modified Karnofsky Performance Status</div>
                <a href="diagnostic/akps.html" class="btn-start-assess">Start Assessment</a>
            </div>

            <div class="pamphlet-section">
                <div class="pamphlet-title">RUG-ADL</div>
                <div class="pamphlet-subtitle">Resource Utilization Groups - ADL</div>
                <a href="diagnostic/rug-adl.html" class="btn-start-assess">Start Assessment</a>
            </div>

            <div class="pamphlet-section">
                <div class="pamphlet-title">RDOS</div>
                <div class="pamphlet-subtitle">Respiratory Distress Observation Scale</div>
                <a href="diagnostic/rdos.html" class="btn-start-assess">Start Assessment</a>
            </div>

        </section>

    </div> 

    <div id="settingsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin:0; font-size: 18px;">üè• Custom Header Settings</h2>
                <button class="close-btn" id="closeSettingsBtn">&times;</button>
            </div>
            <p style="font-size:12px; color:#666; margin-bottom:15px;">Settings saved to this device only.</p>
            
            <form id="institutionForm">
                <div class="form-group">
                    <label>Logos (Select max 2)</label>
                    <div class="logo-selection-area">
                        <div class="logo-gallery" id="logoGallery"></div>
                        <div class="custom-upload-box" id="uploadTrigger">
                            <i class="bi bi-cloud-upload"></i> Upload Logo
                            <input type="file" id="logoFileInput" accept="image/*" style="display: none;">
                        </div>
                        <div class="selected-logos-preview" id="selectedLogosPreview"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="institutionNameInput">Institution Name</label>
                    <input type="text" id="institutionNameInput" required>
                </div>
                <div class="form-group">
                    <label for="institutionContactInput">Contact Number</label>
                    <input type="tel" id="institutionContactInput" required>
                </div>
                <div class="form-group" style="margin-top: 20px;">
                    <label>üîê Login Password</label>
                    <input type="password" id="loginPassword" required>
                    <div class="password-error" id="passwordError">‚ùå Password incorrect.</div>
                </div>
                <button type="submit" class="btn-save" id="saveBtn">üíæ Save Settings</button>
            </form>
        </div>
    </div>

    <div id="reportModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 style="margin:0; font-size: 18px;">üìã Clinical Handover</h2>
                <button class="close-btn" onclick="closeReportModal()">&times;</button>
            </div>
            
            <p style="font-size:12px; color:#666; margin-bottom:15px;">
                Verify scores below. You can manually type or edit results.
            </p>

            <div class="report-grid">
                <div class="input-group">
                    <label>FLACC</label>
                    <input type="text" id="input_flacc" placeholder="-">
                </div>
                <div class="input-group">
                    <label>RASS</label>
                    <input type="text" id="input_rass" placeholder="-">
                </div>
                <div class="input-group">
                    <label>AKPS</label>
                    <input type="text" id="input_akps" placeholder="-">
                </div>
                <div class="input-group">
                    <label>RUG-ADL</label>
                    <input type="text" id="input_rug" placeholder="-">
                </div>
                <div class="input-group">
                    <label>RDOS</label>
                    <input type="text" id="input_rdos" placeholder="-">
                </div>
            </div>

            <div class="report-actions-vertical" style="display:flex; flex-direction:column; gap:10px;">
                <button class="btn-start-assess" style="background:#25D366; border:none; margin-top:0;" onclick="copyReport()">
                    <i class="bi bi-whatsapp"></i> Copy for WhatsApp
                </button>

                <button class="btn-start-assess" style="background:#4285F4; border:none; margin-top:0;" onclick="sendToGoogleForm()">
                    <i class="bi bi-cloud-upload"></i> Fill Patient Details & Submit
                </button>
                
                <button onclick="clearReport()" style="background:none; border:none; color:#dc3545; text-decoration:underline; cursor:pointer; font-size:12px; padding:10px;">
                    Clear All Data
                </button>
            </div>
        </div>
    </div>

    <script src="diagnostic.js"></script>

    <footer class="legal-footer">
        <div class="container">
            <p class="copyright-text">&copy; 2026 Alivioscript Solutions</p>
            <div class="author-info">
                <span class="author-name">Author: Alison Chai</span>
                <span class="author-creds">RPh (M'sia):&nbsp;9093 &nbsp;|&nbsp; GPhC (UK):&nbsp;2077838</span>
            </div>
            <p class="legal-warning">For professional use only. Verify all results.</p>
        </div>
    </footer>

</body>
</html>